<!DOCTYPE html>
<html>
<head>
    <title>Tree: Saving</title>
    <link charset="utf-8" href="../../../codebase/webix.css?v=7.0.1" rel="stylesheet" type="text/css">
    <script charset="utf-8" src="../../../codebase/webix.js?v=7.0.1" type="text/javascript"></script>

    <link href="../../common/samples.css?v=7.0.1" rel="stylesheet" type="text/css">
</head>
<body>
<div class='header_comment'>Saving</div>
<div class='sample_comment'>
    The sample demonstrates saving tree after changes:<br>add/update/delete item, changing parent using drag-n-drop
</div>
<div id="testA" style='width:250px; height:250px; float:left'></div>

<script charset="utf-8" type="text/javascript">

    webix.protoUI({
        name: "edittree"
    }, webix.EditAbility, webix.ui.tree);

    var tree = {
        id: "datatree1",
        view: "edittree",
        template: "{common.icon()} {common.folder()} <span>#title#</span>",
        editable: true,
        editaction: "dblclick",
        editor: "text",
        editValue: "title",
        select: "multiselect",
        drag: true,

        url: "server/datatree.php",
        save: "server/datatree_save.php"
    };

    var buttons = {
        view: "toolbar", elements: [
            {
                view: "button", value: "Add Row", click: function () {
                    var tree = $$('datatree1');
                    var parent = tree.getSelectedId() || 0;
                    tree.add({title: ""}, 0, parent);
                    tree.open(parent);
                }
            },
            {
                view: "button", value: "Delete Row", click: function () {
                    var tree = $$('datatree1');
                    var id = tree.getSelectedId();
                    if (id)
                        tree.remove(id);
                }
            },
            {}
        ]
    };

    webix.ready(function () {
        treea = webix.ui({
            container: "testA",
            rows: [
                buttons, tree
            ]
        });
        $$("datatree1").attachEvent("onafterdrop", function (details) {
            this.updateItem(details.start);
        });
    });
</script>
</body>
</html>